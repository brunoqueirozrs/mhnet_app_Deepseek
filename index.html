<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MHNET Externas â€” Rota & Leads</title>
  <meta name="theme-color" content="#0f766e"/>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <img src="mhnet-logo.png" alt="MHnet Logo" class="logo">
      <div class="brand-text">
        <div class="title">App Rota Lajeado</div>
        <div class="subtitle" id="userInfo">Selecione um vendedor</div>
      </div>
    </div>
    <button id="menuBtn" class="menu-btn" aria-label="menu" onclick="toggleUserMenu()">ğŸ‘¤</button>
  </header>

  <!-- Menu de seleÃ§Ã£o de usuÃ¡rio -->
  <div id="userMenu" class="card" style="display:none; position:absolute; top:70px; right:20px; z-index:1000; width:250px;">
    <h3>Selecionar Vendedor</h3>
    <select id="userSelect" style="width:100%; padding:10px; margin-bottom:12px; border-radius:8px; border:1px solid #ddd;">
      <option value="">Selecione...</option>
    </select>
    <button class="btn primary" onclick="setLoggedUser()" style="width:100%;">Confirmar</button>
    <button class="btn" onclick="logout()" style="width:100%; margin-top:8px; background:#f8f9fa;">Trocar Vendedor</button>
  </div>

  <main class="container" id="mainContent" style="display:none;">
    <section id="dashboard" class="card dashboard">
      <h1>Dashboard</h1>
      <p class="muted">VisÃ£o geral das suas atividades em campo</p>

      <div class="grid stats">
        <div class="stat card-sm">
          <div class="stat-title">Total de Leads</div>
          <div class="stat-value" id="statLeads">0</div>
          <div class="stat-sub" id="statLeadsNovos">0 novos</div>
        </div>
        <div class="stat card-sm">
          <div class="stat-title">Rotas Realizadas</div>
          <div class="stat-value" id="statRotas">0</div>
          <div class="stat-sub" id="statRotasKm">0.0 km</div>
        </div>
        <div class="stat card-sm">
          <div class="stat-title">Taxa de ConversÃ£o</div>
          <div class="stat-value" id="statConv">0%</div>
          <div class="stat-sub" id="statFechados">0 fechados</div>
        </div>
      </div>
    </section>

    <section class="card actions">
      <button class="action-btn blue" onclick="showPage('iniciarRota')">ğŸ“ Iniciar Rota</button>
      <button class="action-btn green" onclick="showPage('gestaoLeads')">ğŸ“‹ GestÃ£o de Leads</button>
      <button class="action-btn purple" onclick="showPage('minhasRotas')">ğŸ›£ï¸ Minhas Rotas</button>
      <button class="action-btn orange" onclick="showPage('novaVenda')">ğŸ’° Nova Venda</button>
    </section>

    <!-- GestÃ£o de Leads (NOVA PÃGINA) -->
    <section id="gestaoLeads" class="card page" style="display:none;">
      <h2>ğŸ“‹ GestÃ£o de Leads</h2>
      <p class="muted">Gerencie e acompanhe seus leads</p>

      <div class="lead-actions">
        <button class="lead-action-btn primary" onclick="showPage('cadLead')">â• Cadastrar Lead</button>
        <button class="lead-action-btn secondary" onclick="carregarLeads()">ğŸ”„ Atualizar Lista</button>
        <button class="lead-action-btn tertiary" onclick="exportarLeads()">ğŸ“¤ Exportar Leads</button>
      </div>

      <div style="margin:20px 0;">
        <input id="searchLead" placeholder="ğŸ” Buscar por nome, telefone ou bairro..." 
               style="width:100%; padding:12px; border-radius:10px; border:1px solid #ddd;"
               oninput="renderLeads()">
      </div>

      <div id="listaLeadsGestao"></div>
    </section>

    <!-- Cadastrar Lead -->
    <section id="cadLead" class="card page" style="display:none;">
      <h2>â• Cadastrar Lead</h2>
      <p class="muted">Adicione um novo lead potencial</p>

      <div class="form-row">
        <input id="leadNome" placeholder="ğŸ‘¤ Nome completo">
        <input id="leadTelefone" placeholder="ğŸ“ Telefone/WhatsApp" type="tel">
        <input id="leadEndereco" placeholder="ğŸ  EndereÃ§o (Rua, nÂº)">
        <input id="leadCidade" placeholder="ğŸŒ Cidade" value="Lajeado">
        <input id="leadBairro" placeholder="ğŸ“ Bairro">
        <input id="leadProvedor" placeholder="ğŸ“¡ Provedor atual">
        <select id="leadInteresse">
          <option value="">ğŸ¯ NÃ­vel de interesse</option>
          <option value="ALTO">ALTO</option>
          <option value="MEDIO">MÃ‰DIO</option>
          <option value="BAIXO">BAIXO</option>
        </select>
        <select id="leadStatus">
          <option value="">ğŸ“Š Status do lead</option>
          <option value="NOVO">NOVO</option>
          <option value="EM_ATENDIMENTO">EM ATENDIMENTO</option>
          <option value="AGENDADO">AGENDADO</option>
          <option value="CONVERTIDO">CONVERTIDO</option>
          <option value="PERDIDO">PERDIDO</option>
        </select>
        <textarea id="leadObs" placeholder="ğŸ“ ObservaÃ§Ãµes e anotaÃ§Ãµes"></textarea>
      </div>

      <div class="row">
        <button class="btn primary" onclick="enviarLead()">ğŸ’¾ Salvar Lead</button>
        <button class="btn" onclick="showPage('gestaoLeads')">â†©ï¸ Voltar</button>
      </div>
    </section>

    <!-- Nova Venda -->
    <section id="novaVenda" class="card page" style="display:none;">
      <h2>ğŸ’° Nova Venda - Rodar Contrato</h2>
      <p class="muted">Preencha os dados para gerar o contrato</p>

      <div class="form-row">
        <input type="text" id="vendaNome" placeholder="âœï¸ Nome completo" required>
        <input type="date" id="vendaNascimento" placeholder="ğŸ“… Data de nascimento" required>
        <input type="text" id="vendaCPF" placeholder="ğŸ”¢ CPF" required>
        <input type="email" id="vendaEmail" placeholder="ğŸ“§ E-mail (obrigatÃ³rio)" required>
        <input type="tel" id="vendaTelefone1" placeholder="ğŸ“ Telefone de contato 1" required>
        <input type="tel" id="vendaTelefone2" placeholder="ğŸ“ Telefone de contato 2">
        <input type="text" id="vendaEndereco" placeholder="ğŸ  EndereÃ§o completo" required>
        <input type="text" id="vendaBairro" placeholder="ğŸ“ Bairro" required>
        <input type="text" id="vendaCidade" placeholder="ğŸŒ Cidade" value="Lajeado" required>
        <select id="vendaPlano" required>
          <option value="">ğŸŒ Plano escolhido</option>
          <option value="100MB">100MB - R$ 99,90</option>
          <option value="200MB">200MB - R$ 129,90</option>
          <option value="300MB">300MB - R$ 159,90</option>
          <option value="500MB">500MB - R$ 199,90</option>
        </select>
        <select id="vendaVencimento" required>
          <option value="">ğŸ—“ï¸ Dia de vencimento</option>
          <option value="5">Dia 5</option>
          <option value="10">Dia 10</option>
          <option value="15">Dia 15</option>
          <option value="20">Dia 20</option>
          <option value="25">Dia 25</option>
        </select>
      </div>

      <div class="row">
        <button class="btn primary" onclick="enviarVenda()">ğŸ“‹ Gerar Contrato</button>
        <button class="btn" onclick="showPage('dashboard')">â†©ï¸ Voltar</button>
      </div>
    </section>

    <!-- Iniciar Rota -->
    <section id="iniciarRota" class="card page" style="display:none;">
      <h2>ğŸ“ Iniciar Rota</h2>
      <p class="muted" id="rotaVendedorInfo">Vendedor: </p>
      
      <div class="row" style="gap:10px;">
        <button class="btn start" id="startBtn" onclick="startRoute()">â–¶ï¸ Iniciar</button>
        <button class="btn stop" id="stopBtn" onclick="stopRoute()" disabled>â¹ï¸ Finalizar</button>
      </div>
      
      <div id="routeInfo" class="muted" style="margin-top:10px; padding:10px; background:#f8f9fa; border-radius:8px;"></div>
      
      <button class="btn ghost" onclick="showPage('dashboard')" style="margin-top:15px;">â†©ï¸ Voltar</button>
    </section>

    <!-- Minhas Rotas -->
    <section id="minhasRotas" class="card page" style="display:none;">
      <h2>ğŸ›£ï¸ Minhas Rotas</h2>
      <p class="muted">HistÃ³rico de rotas realizadas</p>
      
      <div id="listaRotas"></div>
      
      <div class="row" style="margin-top:15px;">
        <button class="btn" onclick="carregarRotas()">ğŸ”„ Atualizar</button>
        <button class="btn" onclick="showPage('dashboard')">â†©ï¸ Voltar</button>
      </div>
    </section>

    <!-- Ver Leads (antiga pÃ¡gina) -->
    <section id="verLeads" class="card page" style="display:none;">
      <h2>Leads</h2>
      <input id="searchLeadOld" placeholder="Buscar por nome, telefone ou provedor" oninput="renderLeadsOld()">
      <div id="listaLeads"></div>
      <button class="btn" onclick="showPage('dashboard')">Voltar</button>
    </section>

    <!-- ConfiguraÃ§Ãµes (Gerenciar vendedores) -->
    <section id="configVendedores" class="card page" style="display:none;">
      <h2>ğŸ‘¥ Vendedores</h2>
      <p class="muted">Gerencie a equipe de vendedores</p>
      
      <div class="form-row">
        <input id="novoVend" placeholder="Nome do novo vendedor">
        <button class="btn primary" onclick="addNovoVendedor()">â• Adicionar</button>
      </div>
      
      <div id="listaVend" style="margin-top:15px;"></div>
      
      <button class="btn" onclick="showPage('dashboard')" style="margin-top:15px;">â†©ï¸ Voltar</button>
    </section>

  </main>

  <footer class="footer">
    <small>MHnet â€¢ App Rota Lajeado â€¢ Vendedor: <span id="footerUser">NÃ£o logado</span></small>
  </footer>

  <script src="app.js"></script>
</body>
</html>
